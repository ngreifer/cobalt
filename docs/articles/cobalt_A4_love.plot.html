<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Appendix 4: Using love.plot To Generate Love Plots • cobalt</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Appendix 4: Using love.plot To Generate Love Plots">
<meta property="og:description" content="cobalt">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cobalt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">4.2.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/cobalt.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cobalt_A1_other_packages.html">Appendix 1: Using cobalt with Other Preprocessing Packages</a>
    </li>
    <li>
      <a href="../articles/cobalt_A2_segmented_data.html">Appendix 2: Using cobalt with Clustered, Multiply Imputed, and Other Segmented Data</a>
    </li>
    <li>
      <a href="../articles/cobalt_A3_longitudinal_treat.html">Appendix 3: Using cobalt with Longitudinal Treatments</a>
    </li>
    <li>
      <a href="../articles/cobalt_A4_love.plot.html">Appendix 4: Using love.plot To Generate Love Plots</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ngreifer/cobalt/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="cobalt_A4_love.plot_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Appendix 4: Using love.plot To Generate Love Plots</h1>
                        <h4 class="author">Noah Greifer</h4>
            
            <h4 class="date">2020-08-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ngreifer/cobalt/blob/master/vignettes/cobalt_A4_love.plot.Rmd"><code>vignettes/cobalt_A4_love.plot.Rmd</code></a></small>
      <div class="hidden name"><code>cobalt_A4_love.plot.Rmd</code></div>

    </div>

    
    
<p>This is a guide on how to use <code><a href="../reference/love.plot.html">love.plot()</a></code> to its fullest potential, taking advantage of all of its many options and features. Other vignettes have described the basics of <code><a href="../reference/love.plot.html">love.plot()</a></code>, but this guide goes more in depth. See the help file for <code><a href="../reference/love.plot.html">love.plot()</a></code> with <code><a href="../reference/love.plot.html">?love.plot</a></code> for the full documentation.</p>
<p>This document will only go over the options for <code><a href="../reference/love.plot.html">love.plot()</a></code> with binary treatments. Many of the options apply to continuous and multi-category treatments and clustered and multiply imputed data as well. I’ll use the Lalonde data and <code>WeightIt</code> for all examples. <code>WeightIt</code> performs a variety of weighting methods, including propensity score weighting, which, for simplicity, will be the focus here.</p>
<p>First, let’s load in the data set and estimate the weights.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">cobalt</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"lalonde"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"cobalt"</span>)

<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">WeightIt</span>)
<span class="no">w.out1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/WeightIt/man/weightit.html">weightit</a></span>(<span class="no">treat</span> ~ <span class="no">age</span> + <span class="no">educ</span> + <span class="no">married</span> + <span class="no">nodegree</span> + <span class="no">race</span> + <span class="no">re74</span> + <span class="no">re75</span>,
                   <span class="kw">data</span> <span class="kw">=</span> <span class="no">lalonde</span>, <span class="kw">estimand</span> <span class="kw">=</span> <span class="st">"ATE"</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"ps"</span>)</pre></body></html></div>
<p>Next, because in this example we want to display standardized mean difference for all of the covariates, let’s set the global <code>binary</code> option to <code>"std"</code> so we don’t have to type it every time.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="../reference/set.cobalt.options.html">set.cobalt.options</a></span>(<span class="kw">binary</span> <span class="kw">=</span> <span class="st">"std"</span>)</pre></body></html></div>
<p>The most basic way to use <code><a href="../reference/love.plot.html">love.plot()</a></code> is simply to call it as you would <code><a href="../reference/bal.tab.html">bal.tab()</a></code> on the output of the preprocessing function (in this case, <code>weightit</code>).</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="../reference/love.plot.html">love.plot</a></span>(<span class="no">w.out1</span>)</pre></body></html></div>
<p><img src="cobalt_A4_love.plot_files/figure-html/unnamed-chunk-4-1.png" width="576"></p>
<p>We could also have supplied other arguments that would normally go in <code><a href="../reference/bal.tab.html">bal.tab()</a></code><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co">#This produces the same output as the prior block but with </span>
<span class="co">#the additional covariates included in the formula.</span>
<span class="fu"><a href="../reference/love.plot.html">love.plot</a></span>(<span class="no">treat</span> ~ <span class="no">age</span> + <span class="no">educ</span> + <span class="no">married</span> + <span class="no">nodegree</span> + <span class="no">race</span> + <span class="no">re74</span> + <span class="no">re75</span> +
            <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(<span class="no">age</span>^<span class="fl">2</span>) + <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(<span class="no">educ</span>^<span class="fl">2</span>), <span class="kw">data</span> <span class="kw">=</span> <span class="no">lalonde</span>, <span class="kw">weights</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get.w.html">get.w</a></span>(<span class="no">w.out1</span>),
          <span class="kw">method</span> <span class="kw">=</span> <span class="st">"weighting"</span>, <span class="kw">estimand</span> <span class="kw">=</span> <span class="st">"ATE"</span>)</pre></body></html></div>
<p>Let’s start with some basic customizations. First, we’ll remove the propensity score from the balance display by setting <code>drop.distance = TRUE</code>. We’ll change the order the covariates so they are displayed in descending order of their unadjusted mean differences by setting <code>var.order = "unadjusted"</code>. We’ll display the absolute mean difference by setting <code>abs = TRUE</code>. We’ll also add some lines to make the change in balance clearer by setting <code>line = TRUE</code>. Finally, we’ll add a threshold line at 0.1 by setting <code>thresholds = c(m = .1)</code>.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="../reference/love.plot.html">love.plot</a></span>(<span class="no">w.out1</span>,
          <span class="kw">drop.distance</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
          <span class="kw">var.order</span> <span class="kw">=</span> <span class="st">"unadjusted"</span>,
          <span class="kw">abs</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
          <span class="kw">line</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
          <span class="kw">thresholds</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">m</span> <span class="kw">=</span> <span class="fl">.1</span>))</pre></body></html></div>
<p><img src="cobalt_A4_love.plot_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
<p>The plot is already looking much better and more informative, but let’s change a few things to make it more professional. First, we’ll change the names of the variables so they are easier to read. We can create a vector of new variable names and then supply that to the <code>var.names</code> argument in <code><a href="../reference/love.plot.html">love.plot()</a></code>. If it would be a burden to type out all the names, you can use the <code><a href="../reference/var.names.html">var.names()</a></code> function to create a CSV file (i.e., spreadsheet) that can be customized and loaded back into R to be used with <code><a href="../reference/love.plot.html">love.plot()</a></code>. See <code><a href="../reference/var.names.html">?var.names</a></code> for more information. Because we only have a few variable names, we’ll just manually create a vector of names.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">new.names</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">age</span> <span class="kw">=</span> <span class="st">"Age (Years)"</span>,
               <span class="kw">educ</span> <span class="kw">=</span> <span class="st">"Education (Years)"</span>,
               <span class="kw">married</span> <span class="kw">=</span> <span class="st">"Married (Y/N)"</span>,
               <span class="kw">nodegree</span> <span class="kw">=</span> <span class="st">"Degree Earned (Y/N)"</span>,
               <span class="kw">race_white</span> <span class="kw">=</span> <span class="st">"Race: White"</span>,
               <span class="kw">race_black</span> <span class="kw">=</span> <span class="st">"Race: Black"</span>,
               <span class="kw">race_hispan</span> <span class="kw">=</span> <span class="st">"Race: Hispanic"</span>,
               <span class="kw">re74</span> <span class="kw">=</span> <span class="st">"Earnings in 1974 ($)"</span>,
               <span class="kw">re75</span> <span class="kw">=</span> <span class="st">"Earnings in 1975 ($)"</span>
)</pre></body></html></div>
<p>We’ll change the colors of the points and lines with the <code>colors</code> argument so they aren’t the <code>ggplot2</code> defaults. We’ll also change the shape of the points to further clarify the different samples using the <code>shapes</code> argument.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="../reference/love.plot.html">love.plot</a></span>(<span class="no">w.out1</span>,
          <span class="kw">drop.distance</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
          <span class="kw">var.order</span> <span class="kw">=</span> <span class="st">"unadjusted"</span>,
          <span class="kw">abs</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
          <span class="kw">line</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
          <span class="kw">thresholds</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">m</span> <span class="kw">=</span> <span class="fl">.1</span>),
          <span class="kw">var.names</span> <span class="kw">=</span> <span class="no">new.names</span>,
          <span class="kw">colors</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"red"</span>, <span class="st">"blue"</span>),
          <span class="kw">shapes</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"triangle filled"</span>, <span class="st">"circle filled"</span>))</pre></body></html></div>
<p><img src="cobalt_A4_love.plot_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
<p>Finally, let’s makes some changed to the legend. First, we’ll rename the samples to be “Unweighted” and “PS Weighted” using the <code>sample.names</code> argument. Second, we’ll change the plot limits to give more padding on the right side using the <code>limits</code> argument. Third, to save some space, we’ll move the legend into the plot using the <code>position</code> argument, and we’ll give it a border. We can do this last step using <code>ggplot2</code> syntax because the <code>love.plot</code> output is a <code>ggplot</code> object. We need to load in <code>ggplot2</code> first to do this.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)

<span class="fu"><a href="../reference/love.plot.html">love.plot</a></span>(<span class="no">w.out1</span>,
          <span class="kw">drop.distance</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
          <span class="kw">var.order</span> <span class="kw">=</span> <span class="st">"unadjusted"</span>,
          <span class="kw">abs</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
          <span class="kw">line</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
          <span class="kw">thresholds</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">m</span> <span class="kw">=</span> <span class="fl">.1</span>),
          <span class="kw">var.names</span> <span class="kw">=</span> <span class="no">new.names</span>,
          <span class="kw">colors</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"red"</span>, <span class="st">"blue"</span>),
          <span class="kw">shapes</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"triangle filled"</span>, <span class="st">"circle filled"</span>),
          <span class="kw">sample.names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Unweighted"</span>, <span class="st">"PS Weighted"</span>),
          <span class="kw">limits</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">.82</span>),
          <span class="kw">position</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.75</span>, <span class="fl">.25</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">legend.box.background</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span>(),
        <span class="kw">legend.box.margin</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span>(<span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>))</pre></body></html></div>
<p><img src="cobalt_A4_love.plot_files/figure-html/unnamed-chunk-9-1.png" width="576"></p>
<p>This is starting to look like a publication-ready plot. There are still other options you can change, such as the title, subtitle, and axis names, some of which can be done using <code>love.plot</code> arguments and others which require <code>ggplot2</code> code. Sizing the plot and making sure everything still looks good will be its own challenge, but that’s true of all plots in R.</p>
<p>Perhaps we want to display balance for a second set of weights, maybe using a different method to estimate them, like the covariate balancing propensity score (CBPS, Imai &amp; Ratkovic, 2014) that is popular in political science. These can be easily added (but we’ll have to use the formula interface to set multiple weights).</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">w.out2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/WeightIt/man/weightit.html">weightit</a></span>(<span class="no">treat</span> ~ <span class="no">age</span> + <span class="no">educ</span> + <span class="no">married</span> + <span class="no">nodegree</span> + <span class="no">race</span> + <span class="no">re74</span> + <span class="no">re75</span>,
                   <span class="kw">data</span> <span class="kw">=</span> <span class="no">lalonde</span>, <span class="kw">estimand</span> <span class="kw">=</span> <span class="st">"ATE"</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"cbps"</span>)

<span class="fu"><a href="../reference/love.plot.html">love.plot</a></span>(<span class="no">treat</span> ~ <span class="no">age</span> + <span class="no">educ</span> + <span class="no">married</span> + <span class="no">nodegree</span> + <span class="no">race</span> + <span class="no">re74</span> + <span class="no">re75</span>,
          <span class="kw">data</span> <span class="kw">=</span> <span class="no">lalonde</span>, <span class="kw">estimand</span> <span class="kw">=</span> <span class="st">"ATE"</span>,
          <span class="kw">weights</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">w1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get.w.html">get.w</a></span>(<span class="no">w.out1</span>),
                         <span class="kw">w2</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get.w.html">get.w</a></span>(<span class="no">w.out2</span>)),
          <span class="kw">var.order</span> <span class="kw">=</span> <span class="st">"unadjusted"</span>,
          <span class="kw">abs</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
          <span class="kw">line</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
          <span class="kw">thresholds</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">m</span> <span class="kw">=</span> <span class="fl">.1</span>),
          <span class="kw">var.names</span> <span class="kw">=</span> <span class="no">new.names</span>,
          <span class="kw">colors</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"darkgreen"</span>),
          <span class="kw">shapes</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"triangle filled"</span>, <span class="st">"circle filled"</span>, <span class="st">"square filled"</span>),
          <span class="kw">sample.names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Unweighted"</span>, <span class="st">"PS Weighted"</span>, <span class="st">"CBPS Weighted"</span>),
          <span class="kw">limits</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">.82</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">legend.position</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.75</span>, <span class="fl">.3</span>),
        <span class="kw">legend.box.background</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span>(),
        <span class="kw">legend.box.margin</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span>(<span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>))</pre></body></html></div>
<p><img src="cobalt_A4_love.plot_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
<p>We can see there is little benefit to using these weights over standard logistic regression weights, although significant imbalance remains for both sets of weights. (Try using entropy balancing by setting <code>method = "ebal"</code> in <code><a href="https://rdrr.io/pkg/WeightIt/man/weightit.html">weightit()</a></code> if you want to see the power of modern weighting methods.)</p>
<p>Perhaps balance on mean differences is not enough, and you want to display balance on KS statistics. In general, this is good practice; mean differences don’t tell the whole story. We can simply request <code>stats = ks.statistics"</code> in <code><a href="../reference/love.plot.html">love.plot()</a></code>. We could also request <code>"variance.ratios"</code> to get variance ratios, another potentially useful balance measure. Below we’ll use similar formatting to request KS statistics:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="../reference/love.plot.html">love.plot</a></span>(<span class="no">treat</span> ~ <span class="no">age</span> + <span class="no">educ</span> + <span class="no">married</span> + <span class="no">nodegree</span> + <span class="no">race</span> + <span class="no">re74</span> + <span class="no">re75</span>,
          <span class="kw">data</span> <span class="kw">=</span> <span class="no">lalonde</span>, <span class="kw">estimand</span> <span class="kw">=</span> <span class="st">"ATE"</span>,
          <span class="kw">stats</span> <span class="kw">=</span> <span class="st">"ks.statistics"</span>,
          <span class="kw">weights</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">w1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get.w.html">get.w</a></span>(<span class="no">w.out1</span>),
                         <span class="kw">w2</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get.w.html">get.w</a></span>(<span class="no">w.out2</span>)),
          <span class="kw">var.order</span> <span class="kw">=</span> <span class="st">"unadjusted"</span>,
          <span class="kw">abs</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
          <span class="kw">line</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
          <span class="kw">thresholds</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">m</span> <span class="kw">=</span> <span class="fl">.1</span>),
          <span class="kw">var.names</span> <span class="kw">=</span> <span class="no">new.names</span>,
          <span class="kw">colors</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"darkgreen"</span>),
          <span class="kw">shapes</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"triangle filled"</span>, <span class="st">"circle filled"</span>, <span class="st">"square filled"</span>),
          <span class="kw">sample.names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Unweighted"</span>, <span class="st">"PS Weighted"</span>, <span class="st">"CBPS Weighted"</span>),
          <span class="kw">limits</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">.45</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">legend.position</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.75</span>, <span class="fl">.25</span>),
        <span class="kw">legend.box.background</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span>(),
        <span class="kw">legend.box.margin</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span>(<span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>))</pre></body></html></div>
<p><img src="cobalt_A4_love.plot_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
<p>Below, we’ll put two plots side-by-side, one for mean differences and one for KS statistics. This can be done by requesting multiple values for the <code>stats</code> argument (e.g., with <code>stats = c("mean.diffs", "ks.statistics")</code>). To reduce clutter, we’ll remove the lines by setting <code>lines = FALSE</code>. To prevent the axis titles from bumping into each other, we’ll set <code>wrap = 20</code>, where 20 is the number of characters at which to wrap to the next line. When <code>stats</code> has length greater than 1, the output is not longer a <code>ggplot</code> object and can’t be manipulated using <code>ggplot2</code> syntax. This limits some of the options we have to customize it, but the available options using <code><a href="../reference/love.plot.html">love.plot()</a></code>’s syntax are still useful. We’ll move the legend to the top of the plot to save space using the <code>position</code> argument. We can give the plots different limits by entering a named list into the <code>limits</code> argument. We can do the same for the <code>thresholds</code> argument. Finally, by setting <code>var.order = "unadjusted"</code>, we ensure that the variable order is the same in both plots (which it will be regardless) and ordered by the first balance statistic (in this case, mean differences).</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="../reference/love.plot.html">love.plot</a></span>(<span class="no">treat</span> ~ <span class="no">age</span> + <span class="no">educ</span> + <span class="no">married</span> + <span class="no">nodegree</span> + <span class="no">race</span> + <span class="no">re74</span> + <span class="no">re75</span>,
          <span class="kw">data</span> <span class="kw">=</span> <span class="no">lalonde</span>, <span class="kw">estimand</span> <span class="kw">=</span> <span class="st">"ATE"</span>,
          <span class="kw">stats</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"mean.diffs"</span>, <span class="st">"ks.statistics"</span>),
          <span class="kw">weights</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">w1</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get.w.html">get.w</a></span>(<span class="no">w.out1</span>),
                         <span class="kw">w2</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get.w.html">get.w</a></span>(<span class="no">w.out2</span>)),
          <span class="kw">var.order</span> <span class="kw">=</span> <span class="st">"unadjusted"</span>,
          <span class="kw">abs</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
          <span class="kw">line</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
          <span class="kw">thresholds</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">m</span> <span class="kw">=</span> <span class="fl">.1</span>, <span class="kw">ks</span> <span class="kw">=</span> <span class="fl">.05</span>),
          <span class="kw">var.names</span> <span class="kw">=</span> <span class="no">new.names</span>,
          <span class="kw">colors</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"darkgreen"</span>),
          <span class="kw">shapes</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"triangle filled"</span>, <span class="st">"circle filled"</span>, <span class="st">"square filled"</span>),
          <span class="kw">sample.names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Unweighted"</span>, <span class="st">"PS Weighted"</span>, <span class="st">"CBPS Weighted"</span>),
          <span class="kw">limits</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">m</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">.82</span>),
                        <span class="kw">ks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">.45</span>)),
          <span class="kw">wrap</span> <span class="kw">=</span> <span class="fl">20</span>,
          <span class="kw">position</span> <span class="kw">=</span> <span class="st">"top"</span>)</pre></body></html></div>
<p><img src="cobalt_A4_love.plot_files/figure-html/unnamed-chunk-12-1.png" width="576"></p>
<p>Below we recreate the plot in West et al. (2014), which uses a simple theme and avoids color, which can be important for publication. In addition, the plot has labels and puts the legend in a different position. We can include those features by including an argument to <code>labels</code> and by supplying a <code>theme</code> object to <code>themes</code>:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="../reference/love.plot.html">love.plot</a></span>(<span class="no">w.out1</span>, <span class="kw">abs</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
          <span class="kw">stats</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"mean.diffs"</span>, <span class="st">"variance.ratios"</span>),
          <span class="kw">drop.distance</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
          <span class="kw">var.names</span> <span class="kw">=</span> <span class="no">new.names</span>,
          <span class="kw">thresholds</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">v</span> <span class="kw">=</span> <span class="fl">2</span>),
          <span class="kw">limits</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">m</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">.9</span>, <span class="fl">.9</span>),
                        <span class="kw">v</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.3</span>, <span class="fl">6</span>)),
          <span class="kw">shapes</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"circle filled"</span>, <span class="st">"circle"</span>),
          <span class="kw">position</span> <span class="kw">=</span> <span class="st">"none"</span>,
          <span class="kw">labels</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
          <span class="kw">title</span> <span class="kw">=</span> <span class="kw">NULL</span>,
          <span class="kw">wrap</span> <span class="kw">=</span> <span class="fl">20</span>,
          <span class="kw">themes</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">v</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">legend.position</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.75</span>, <span class="fl">1.09</span>),
                                  <span class="kw">legend.title</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
                                  <span class="kw">legend.key.size</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/reexports.html">unit</a></span>(<span class="fl">.02</span>, <span class="st">"npc"</span>))))</pre></body></html></div>
<p><img src="cobalt_A4_love.plot_files/figure-html/unnamed-chunk-13-1.png" width="576"></p>
<p>When using <code>love.plot</code>, you might see a warning that says <code>Standardized mean differences and raw mean differences are present in the same plot. Use the 'stars' argument to distinguish between them and appropriately label the x-axis.</code>. We avoided this here by setting <code>binary</code> to <code>"std"</code> so that only standardized mean differences are produced when requesting <code>stats = "mean.diffs"</code>. The <code>stars</code> argument adds an asterisk (or a character of your choice) to the names of variables that either have standardized mean difference or raw mean differences, whichever you choose. The idea is that the asterisk will be explain in a caption below the plot, indicating that the axis title doesn’t fully represent how that variable’s mean difference is displayed. For example, you might make the following plot:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu"><a href="../reference/love.plot.html">love.plot</a></span>(<span class="no">w.out1</span>, <span class="kw">binary</span> <span class="kw">=</span> <span class="st">"raw"</span>,
          <span class="kw">stars</span> <span class="kw">=</span> <span class="st">"raw"</span>,
          <span class="kw">drop.distance</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
          <span class="kw">var.names</span> <span class="kw">=</span> <span class="no">new.names</span>)</pre></body></html></div>
<p><img src="cobalt_A4_love.plot_files/figure-html/unnamed-chunk-14-1.png" width="576"></p>
<p>By setting <code>stars = "raw"</code>, asterisks appear next to the variables for which the raw difference in means (i.e., proportions) is displayed, contradicting the axis title. In the figure’s caption, you might write</p>
<blockquote>
<p>* indicates variables for which the displayed value is the raw (unstandardized) difference in means.</p>
</blockquote>
<p>This ensures readers can fully and accurately interpret the plot. My suggestion is to display standardized mean differences for all variables as well as KS statistics. The KS statistic for a binary variable is the raw difference in proportion, so that information is not lost.</p>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Imai, K., &amp; Ratkovic, M. (2014). Covariate balancing propensity score. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 76(1), 243–263. <a href="https://doi.org/10.1111/rssb.12027" class="uri">https://doi.org/10.1111/rssb.12027</a></p>
<p>West, S. G., Cham, H., Thoemmes, F., Renneberg, B., Schulze, J., &amp; Weiler, M. (2014). Propensity scores as a basis for equating groups: Basic principles and application in clinical treatment outcome research. Journal of Consulting and Clinical Psychology, 82(5), 906–919. <a href="https://doi.org/10.1037/a0036387" class="uri">https://doi.org/10.1037/a0036387</a></p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Older versions of <code>cobalt</code> required the first argument to be a call to <code><a href="../reference/bal.tab.html">bal.tab()</a></code>; this is no longer required and in fact is not recommended because <code>love.plot</code> is more flexible when handling its own inputs. That said, <code>love.plot</code> calls <code>bal.tab</code> internally, so problems that arise may be due to problems with <code>bal.tab</code> rather than with <code>love.plot</code>. Sometimes the <code>bal.tab</code> object can take some time to be produced, in which case it might be useful to just run <code>bal.tab</code> once and supply its output to different calls of <code>love.plot</code> as you fiddle with its options, as <code>b &lt;- bal.tab(w.out); love.plot(b)</code>. Note that doing so removes some of <code>love.plot</code> flexibility. The most important aspect is that <code>love.plot</code> when called with the first syntax can modify the implicit call to <code>bal.tab</code> to get everything it needs. For example, normally variance ratios are not present in <code>bal.tab</code> output, but if they are requested with <code>stats = "variance.ratios"</code> in <code>love.plot</code>, they will be produced and displayed correctly without additional input. When using the latter syntax, an error will occur saying that variance ratios were not present in the original <code>bal.tab</code> call. This can be mitigated by setting <code>quick = FALSE</code> or including <code>"variance.ratios"</code> in the <code>stats</code> argument in the call to <code>bal.tab</code> before entering its output into <code>love.plot</code>.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Noah Greifer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
