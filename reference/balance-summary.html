<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="These functions quickly compute balance statistics for the given covariates. These functions are used in bal.tab(), but they are available for use in programming without having to call bal.tab() to get them.
col_w_mean() computes the (weighted) means for a set of covariates and weights and is essentially a weighted version of colMeans().
col_w_sd() computes the (weighted) standard deviations for a set of covariates and weights.
col_w_smd() computes the (weighted) (absolute) (standardized) difference in means for a set of covariates, a binary treatment, and weights.
col_w_vr() computes the (weighted) variance ratio for a set of covariates, a binary treatment, and weights.
col_w_ks() computes the (weighted) Kolmogorov-Smirnov (KS) statistic for a set of covariates, a binary treatment, and weights.
col_w_ovl() computes the complement of the (weighted) overlapping coefficient compliment for a set of covariates, a binary treatment, and weights (based on Franklin et al, 2014).
col_w_cov() and col_w_corr() compute the (weighted) (absolute) treatment-covariate covariance or correlation for a set of covariates, a continuous treatment, and weights.

"><title>Compute Balance and Summary Statistics for Covariates — balance-summary • cobalt</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute Balance and Summary Statistics for Covariates — balance-summary"><meta property="og:description" content="These functions quickly compute balance statistics for the given covariates. These functions are used in bal.tab(), but they are available for use in programming without having to call bal.tab() to get them.
col_w_mean() computes the (weighted) means for a set of covariates and weights and is essentially a weighted version of colMeans().
col_w_sd() computes the (weighted) standard deviations for a set of covariates and weights.
col_w_smd() computes the (weighted) (absolute) (standardized) difference in means for a set of covariates, a binary treatment, and weights.
col_w_vr() computes the (weighted) variance ratio for a set of covariates, a binary treatment, and weights.
col_w_ks() computes the (weighted) Kolmogorov-Smirnov (KS) statistic for a set of covariates, a binary treatment, and weights.
col_w_ovl() computes the complement of the (weighted) overlapping coefficient compliment for a set of covariates, a binary treatment, and weights (based on Franklin et al, 2014).
col_w_cov() and col_w_corr() compute the (weighted) (absolute) treatment-covariate covariance or correlation for a set of covariates, a continuous treatment, and weights.

"><meta property="og:image" content="https://ngreifer.github.io/cobalt/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">cobalt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.5.0.9001</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/cobalt.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/other-packages.html">Using `cobalt` with Other Preprocessing Packages</a>
    <a class="dropdown-item" href="../articles/segmented-data.html">Using `cobalt` with Clustered, Multiply Imputed, and Other Segmented Data</a>
    <a class="dropdown-item" href="../articles/longitudinal-treat.html">Using `cobalt` with Longitudinal Treatments</a>
    <a class="dropdown-item" href="../articles/love.plot.html">Using `love.plot()` To Generate Love Plots</a>
    <a class="dropdown-item" href="../articles/optimizing-balance.html">Optimizing Tuning Parameters for Balance</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ngreifer/cobalt/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Compute Balance and Summary Statistics for Covariates</h1>
      <small class="dont-index">Source: <a href="https://github.com/ngreifer/cobalt/blob/HEAD/R/balance-summary.R" class="external-link"><code>R/balance-summary.R</code></a></small>
      <div class="d-none name"><code>balance-summary.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions quickly compute balance statistics for the given covariates. These functions are used in <code><a href="bal.tab.html">bal.tab()</a></code>, but they are available for use in programming without having to call <code><a href="bal.tab.html">bal.tab()</a></code> to get them.</p><ul><li><p><code>col_w_mean()</code> computes the (weighted) means for a set of covariates and weights and is essentially a weighted version of <code><a href="https://rdrr.io/pkg/Matrix/man/colSums.html" class="external-link">colMeans()</a></code>.</p></li>
<li><p><code>col_w_sd()</code> computes the (weighted) standard deviations for a set of covariates and weights.</p></li>
<li><p><code>col_w_smd()</code> computes the (weighted) (absolute) (standardized) difference in means for a set of covariates, a binary treatment, and weights.</p></li>
<li><p><code>col_w_vr()</code> computes the (weighted) variance ratio for a set of covariates, a binary treatment, and weights.</p></li>
<li><p><code>col_w_ks()</code> computes the (weighted) Kolmogorov-Smirnov (KS) statistic for a set of covariates, a binary treatment, and weights.</p></li>
<li><p><code>col_w_ovl()</code> computes the complement of the (weighted) overlapping coefficient compliment for a set of covariates, a binary treatment, and weights (based on Franklin et al, 2014).</p></li>
<li><p><code>col_w_cov()</code> and <code>col_w_corr()</code> compute the (weighted) (absolute) treatment-covariate covariance or correlation for a set of covariates, a continuous treatment, and weights.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">col_w_mean</span><span class="op">(</span></span>
<span>  <span class="va">mat</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  s.weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">col_w_sd</span><span class="op">(</span></span>
<span>  <span class="va">mat</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  s.weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">bin.vars</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">col_w_smd</span><span class="op">(</span></span>
<span>  <span class="va">mat</span>,</span>
<span>  <span class="va">treat</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  std <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  s.d.denom <span class="op">=</span> <span class="st">"pooled"</span>,</span>
<span>  abs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  s.weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">bin.vars</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weighted.weights <span class="op">=</span> <span class="va">weights</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">col_w_vr</span><span class="op">(</span></span>
<span>  <span class="va">mat</span>,</span>
<span>  <span class="va">treat</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  abs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  s.weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">bin.vars</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">col_w_ks</span><span class="op">(</span></span>
<span>  <span class="va">mat</span>,</span>
<span>  <span class="va">treat</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  s.weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">bin.vars</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">col_w_ovl</span><span class="op">(</span></span>
<span>  <span class="va">mat</span>,</span>
<span>  <span class="va">treat</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  s.weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">bin.vars</span>,</span>
<span>  integrate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">col_w_cov</span><span class="op">(</span></span>
<span>  <span class="va">mat</span>,</span>
<span>  <span class="va">treat</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"pearson"</span>,</span>
<span>  std <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  s.d.denom <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  abs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  s.weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">bin.vars</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weighted.weights <span class="op">=</span> <span class="va">weights</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">col_w_corr</span><span class="op">(</span></span>
<span>  <span class="va">mat</span>,</span>
<span>  <span class="va">treat</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"pearson"</span>,</span>
<span>  s.d.denom <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  abs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  s.weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">bin.vars</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weighted.weights <span class="op">=</span> <span class="va">weights</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>mat</dt>
<dd><p>a numeric matrix or a data frame containing the covariates for which the statistic is to be computed. If a data frame, <code><a href="splitfactor.html">splitfactor()</a></code> with <code>drop.first = "if2"</code> will be called if any character or factor variables are present. This can slow down the function, so it's generally best to supply a numeric matrix. If a numeric vector is supplied, it will be converted to a 1-column matrix first.</p></dd>


<dt>weights</dt>
<dd><p><code>numeric</code>; an optional set of weights used to compute the weighted statistics. If sampling weights are supplied through <code>s.weights</code>, the <code>weights</code> should not incorporate these weights, as <code>weights</code> and <code>s.weights</code> will be multiplied together prior to computing the weighted statistics.</p></dd>


<dt>s.weights</dt>
<dd><p><code>numeric</code>; an optional set of sampling weights used to compute the weighted statistics. If weights are supplied through <code>weights</code>, <code>weights</code> and <code>s.weights</code> will be multiplied together prior to computing the weighted statistics. Some functions use <code>s.weights</code> in a particular way; for others, supplying <code>weights</code> and <code>s.weights</code> is equivalent to supplying their product to either <code>weights</code> or <code>s.weights</code>. See Details.</p></dd>


<dt>subset</dt>
<dd><p>a <code>logical</code> vector with length equal to the number of rows of <code>mat</code> used to subset the data. See Details for notes on its use with <code>col_w_smd()</code>, <code>col_w_cov()</code>, and <code>col_w_corr()</code>.</p></dd>


<dt>na.rm</dt>
<dd><p><code>logical</code>; whether <code>NA</code>s should be ignored or not. If <code>FALSE</code>, any variable with any <code>NA</code>s will have its corresponding statistic returned as <code>NA</code>. If <code>TRUE</code>, any variable with any <code>NA</code>s will have its corresponding statistic computed as if the missing value were not there.</p></dd>


<dt>...</dt>
<dd><p>for all functions, additional arguments supplied to <code><a href="splitfactor.html">splitfactor()</a></code> when <code>mat</code> is a data.frame. <code>data</code>, <code>var.name</code>, <code>drop.first</code>, and <code>drop.level</code> are ignored; <code>drop.first</code> is automatically set to <code>"if2"</code>. For <code>col_w_ovl()</code> and <code>col_w_ent()</code>, other arguments passed to <code><a href="https://rdrr.io/r/stats/density.html" class="external-link">density()</a></code> besides <code>x</code> and <code>weights</code>. Note that the default value for <code>bw</code> when unspecified is <code>"nrd"</code> rather than the default in <code><a href="https://rdrr.io/r/stats/density.html" class="external-link">density()</a></code>, which is <code>"nrd0"</code>.</p></dd>


<dt>bin.vars</dt>
<dd><p>a vector used to denote whether each variable is binary or not. Can be a <code>logical</code> vector with length equal to the number of columns of <code>mat</code> or a vector of numeric indices or character names of the binary variables. If missing (the default), the function will figure out which covariates are binary or not, which can increase computation time. If <code>NULL</code>, it will be assumed no variables are binary. All functions other than <code>col_w_mean()</code> treat binary variables different from continuous variables. If a factor or character variable is in <code>mat</code>, all the dummies created will automatically be marked as binary, but it should still receive an entry when <code>bin.vars</code> is supplied as <code>logical</code>.</p></dd>


<dt>treat</dt>
<dd><p>a vector of treatment status for each individual. For <code>col_w_smd()</code>, <code>col_w_vr()</code>, <code>col_w_ks()</code>, and <code>col_w_ovl()</code>, <code>treat</code> should have exactly two unique values. For <code>col_w_cov()</code> and <code>col_w_corr()</code>, <code>treat</code> should be a many-valued numeric vector.</p></dd>


<dt>std</dt>
<dd><p><code>logical</code>; for <code>col_w_smd()</code>, whether the computed mean differences for each variable should be standardized; for <code>col_w_cov()</code>, whether treatment-covariate correlations should be computed (<code>TRUE</code>) rather than covariances (<code>FALSE</code>). Can be either length 1, whereby all variables will be standardized or not, or length equal to the number of columns of <code>mat</code>, whereby only variables with a value of <code>TRUE</code> will be standardized. See Details.</p></dd>


<dt>s.d.denom</dt>
<dd><p>for <code>col_w_smd()</code> and <code>col_w_cov()</code> when <code>std</code> is <code>TRUE</code> for some variables, and for <code>col_w_corr()</code>, how the standardization factor should be computed. For <code>col_w_smd()</code> (i.e., when computing standardized mean differences), allowable options include</p><ul><li><p><code>"treated"</code> - uses the standard deviation of the variable in the treated group</p></li>
<li><p><code>"control"</code> - uses the standard deviation of the variable in the control group</p></li>
<li><p><code>"pooled"</code> - uses the square root of the average of the variances of the variable in the treated and control groups</p></li>
<li><p><code>"all"</code> - uses the standard deviation of the variable in the full sample</p></li>
<li><p><code>"weighted"</code> - uses the standard deviation of the variable in the full sample weighted by <code>weighted.weights</code></p></li>
<li><p><code>"hedges"</code> - uses the small-sample corrected version of Hedge's G described in the WWC Procedures Handbook (see References)</p></li>
<li><p>the name of one of the treatment values - uses the standard deviation of the variable in that treatment group.</p></li>
</ul><p>For <code>col_w_cov()</code> and <code>col_w_corr()</code>, only <code>"all"</code> and <code>"weighted"</code> are allowed. Abbreviations allowed. This can also be supplied as a numeric vector of standard deviations with length equal to the number of columns of <code>mat</code>; the values will be used as the standardization factors.</p></dd>


<dt>abs</dt>
<dd><p><code>logical</code>; for <code>col_w_smd()</code>, <code>col_w_cov()</code>, and <code>col_w_corr()</code>, whether the returned statistics should be in absolute value (<code>TRUE</code>) or not. For <code>col_w_vr()</code>, whether the ratio should always include the larger variance in the numerator, so that the ratio is always greater than or equal to 1. Default is <code>FALSE</code>.</p></dd>


<dt>weighted.weights</dt>
<dd><p>for <code>col_w_smd()</code>, <code>col_w_cov()</code>, and <code>col_w_corr()</code>, when <code>std = TRUE</code> and <code>s.d.denom = "weighted"</code>, a vector of weights to be applied to the computation of the denominator standard deviation. If not specified, will use the argument to <code>weights</code>. When <code>s.d.denom</code> is not <code>"weighted"</code>, this is ignored. The main purpose of this is to allow <code>weights</code> to be <code>NULL</code> while weighting the denominator standard deviations for assessing balance in the unweighted sample but using the standard deviations of the weighted sample.</p></dd>


<dt>integrate</dt>
<dd><p><code>logical</code>; for <code>col_w_ovl()</code>, whether to use <code><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">integrate()</a></code> to calculate the area of overlap or the distance between the densities, respectively. If <code>FALSE</code>, a midpoint Riemann sum with 1000 partitions will be used instead. The Riemann sum is a little slower and very slightly imprecise (unnoticibly in most contexts), but the integral can fail sometimes and thus is less stable. The default is to use the Riemann sum.</p></dd>


<dt>type</dt>
<dd><p>for <code>col_w_cov()</code> and <code>col_w_corr()</code>, the type of covariance/correlation to be computed. Allowable options include <code>"pearson"</code> and <code>"spearman"</code>. When <code>"spearman"</code> is requested, the covariates and treatment are first turned into ranks using <code><a href="https://rdrr.io/r/base/rank.html" class="external-link">rank()</a></code> with <code>na.last = "keep"</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A vector of balance statistics, one for each variable in <code>mat</code>. If <code>mat</code> has column names, the output will be named as well.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>col_w_mean()</code> computes column weighted means for a matrix of variables. It is similar to <code><a href="https://rdrr.io/pkg/Matrix/man/colSums.html" class="external-link">colMeans()</a></code> but (optionally) incorporates weights. <code>weights</code> and <code>s.weights</code> are multiplied together prior to being used, and there is no distinction between them. This could be used to compute the weighted means of each covariate in the general population to examine the degree to which a weighting method has left the weighted samples resembling the original population.</p>
<p><code>col_w_sd()</code> computes column weighted standard deviations for a matrix of variables. <code>weights</code> and <code>s.weights</code> are multiplied together prior to being used, and there is no distinction between them. The variance of binary variables is computed as \(p(1-p)\), where \(p\) is the (weighted) proportion of 1s, while the variance of continuous variables is computed using the standard formula; the standard deviation is the square root of this variance.</p>
<p><code>col_w_smd()</code> computes the mean difference for each covariate between treatment groups defined by <code>treat</code>. These mean differences can optionally be weighted, standardized, and/or in absolute value. The standardization factor is computed using the unweighted standard deviation or variance when <code>s.weights</code> are absent, and is computed using the <code>s.weights</code>-weighted standard deviation or variance when <code>s.weights</code> are present, except when <code>s.d.denom = "weighted"</code>, in which case the product of <code>weighted.weights</code> and <code>s.weights</code> (if present) are used to weight the standardization factor. The standardization factor is computed using the whole sample even when <code>subset</code> is used. Note that unlike <code><a href="bal.tab.html">bal.tab()</a></code>, <code>col_w_smd()</code> requires the user to specify whether each individual variable should be standardized using <code>std</code> rather than relying on <code>continuous</code> or <code>binary</code>. The weighted mean difference is computed using the product of <code>weights</code> and <code>s.weights</code>, if specified. The variance of binary variables is computed as \(p(1-p)\), where \(p\) is the (weighted) proportion of 1s, while the variance of continuous variables is computed using the standard formula.</p>
<p><code>col_w_vr()</code> computes the variance ratio for each covariate between treatment groups defined by <code>treat</code>. When <code>abs = TRUE</code>, <code>pmax(out, 1/out)</code> is applied to the output so that the ratio is always greater than or equal to 1. For binary variables, the variance is computed as \(p(1-p)\), where \(p\) is the (weighted) proportion of 1s, while the variance of continuous variables is computed using the standard formula. Note that in <code><a href="bal.tab.html">bal.tab()</a></code>, variance ratios are not computed for binary variables, while here, they are (but likely should not be interpreted). <code>weights</code> and <code>s.weights</code> are multiplied together prior to being used, and there is no distinction between them. Because of how the weighted variance is computed, exactly balanced groups may have variance ratios that differ slightly from 1.</p>
<p><code>col_w_ks()</code> computes the KS statistic for each covariate using the method implemented in <span class="pkg">twang</span>. The KS statistics can optionally be weighted. For binary variables, the KS statistic is just the difference in proportions. <code>weights</code> and <code>s.weights</code> are multiplied together prior to being used, and there is no distinction between them.</p>
<p><code>col_w_ovl()</code> computes the complement of the overlapping coefficient as described by Franklin et al. (2014). It does so by computing the density of the covariate in the treated and control groups, then finding the area where those density overlap, and subtracting that number from 1, yielding a value between 0 and 1 where 1 indicates complete imbalance, and 0 indicates perfect balance. <code><a href="https://rdrr.io/r/stats/density.html" class="external-link">density()</a></code> is used to model the density in each group. The bandwidth of the covariate in the smaller treatment group is used for both groups. The area of overlap can be computed using <code>integrate</code>, which quickly and accurately computes the integral, or using a midpoint Riemann sum with 1000 partitions, which approximates the area more slowly. A reason to prefer the Riemann sum is that <code>integrate</code> can fail for unknown reasons, though Riemann sums will fail with some extreme distributions. When either method fails, the resulting value will be <code>NA</code>. For binary variables, the complement of the overlapping coefficient is just the difference in proportions. <code>weights</code> and <code>s.weights</code> are multiplied together prior to being used, and there is no distinction between them. The weights are used to compute the weighted density by supplying them to the <code>weights</code> argument of <code>density</code>.</p>
<p><code>col_w_cov()</code> computes the covariance between a continuous treatment and the covariates to assess balance for continuous treatments as recommended in Austin (2019). These covariance can optionally be weighted or in absolute value or can be requested as correlations (i.e., standardized covariances). The correlations are computed as the covariance between the treatment and covariate divided by a standardization factor, which is equal to the square root of the product of the variance of treatment and the variance of the covariate. The standardization factor is computed using the unweighted variances when <code>s.weights</code> are absent, and is computed using the sampling weighted variances when <code>s.weights</code> are present, except when <code>s.d.denom = "weighted"</code>, in which case the product of <code>weighted.weights</code> and <code>s.weights</code> (if present) are used to weight the standardization factor. For this reason, the computed correlation can be greater than 1 or less than -1. The standardization factor is always computed using the whole sample even when <code>subset</code> is used. The covariance is computed using the product of <code>weights</code> and <code>s.weights</code>, if specified. The variance of binary variables is computed as \(p(1-p)\), where \(p\) is the (weighted) proportion of 1s, while the variance of continuous variables is computed using the standard formula.</p>
<p><code>col_w_corr()</code> is a wrapper for <code>col_w_cov</code> with <code>std</code> set to <code>TRUE</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Austin, P. C. (2019). Assessing covariate balance when using the generalized propensity score with quantitative or continuous exposures. <em>Statistical Methods in Medical Research</em>, 28(5), 1365–1377. <a href="https://doi.org/10.1177/0962280218756159" class="external-link">doi:10.1177/0962280218756159</a></p>
<p>Franklin, J. M., Rassen, J. A., Ackermann, D., Bartels, D. B., &amp; Schneeweiss, S. (2014). Metrics for covariate balance in cohort studies of causal effects. <em>Statistics in Medicine</em>, 33(10), 1685–1699. <a href="https://doi.org/10.1002/sim.6058" class="external-link">doi:10.1002/sim.6058</a></p>
<p>What Works Clearinghouse. (2020). WWC Procedures Handbook (Version 4.1). Retrieved from
<a href="https://ies.ed.gov/ncee/wwc/Handbooks" class="external-link">https://ies.ed.gov/ncee/wwc/Handbooks</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="bal.tab.html">bal.tab()</a></code></p></li>
<li><p><code><a href="bal.compute.html">bal.compute()</a></code></p></li>
<li><p><a href="balance-statistics.html">balance-statistics</a></p></li>
</ul></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"lalonde"</span>, package <span class="op">=</span> <span class="st">"cobalt"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">treat</span> <span class="op">&lt;-</span> <span class="va">lalonde</span><span class="op">$</span><span class="va">treat</span></span></span>
<span class="r-in"><span><span class="va">covs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">lalonde</span>, select <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">treat</span>, <span class="va">re78</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">covs0</span> <span class="op">&lt;-</span> <span class="fu"><a href="splitfactor.html">splitfactor</a></span><span class="op">(</span><span class="va">covs</span>, drop.first <span class="op">=</span> <span class="st">"if2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bin.vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>              <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">W</span> <span class="op">&lt;-</span> <span class="fu">WeightIt</span><span class="fu">::</span><span class="fu"><a href="https://ngreifer.github.io/WeightIt/reference/weightit.html" class="external-link">weightit</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">covs</span>, method <span class="op">=</span> <span class="st">"ps"</span>, </span></span>
<span class="r-in"><span>                        estimand <span class="op">=</span> <span class="st">"ATE"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="va">W</span><span class="op">$</span><span class="va">weights</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    m0 <span class="op">=</span> <span class="fu">col_w_mean</span><span class="op">(</span><span class="va">covs0</span>, weights <span class="op">=</span> <span class="va">weights</span>, subset <span class="op">=</span> <span class="va">treat</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    sd0 <span class="op">=</span> <span class="fu">col_w_sd</span><span class="op">(</span><span class="va">covs0</span>, weights <span class="op">=</span> <span class="va">weights</span>,</span></span>
<span class="r-in"><span>                   bin.vars <span class="op">=</span> <span class="va">bin.vars</span>, subset <span class="op">=</span> <span class="va">treat</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    m1 <span class="op">=</span> <span class="fu">col_w_mean</span><span class="op">(</span><span class="va">covs0</span>, weights <span class="op">=</span> <span class="va">weights</span>, subset <span class="op">=</span> <span class="va">treat</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    sd1 <span class="op">=</span> <span class="fu">col_w_sd</span><span class="op">(</span><span class="va">covs0</span>, weights <span class="op">=</span> <span class="va">weights</span>,</span></span>
<span class="r-in"><span>                   bin.vars <span class="op">=</span> <span class="va">bin.vars</span>, subset <span class="op">=</span> <span class="va">treat</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    smd <span class="op">=</span> <span class="fu">col_w_smd</span><span class="op">(</span><span class="va">covs0</span>, treat <span class="op">=</span> <span class="va">treat</span>, weights <span class="op">=</span> <span class="va">weights</span>,</span></span>
<span class="r-in"><span>                    std <span class="op">=</span> <span class="cn">TRUE</span>, bin.vars <span class="op">=</span> <span class="va">bin.vars</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    vr <span class="op">=</span> <span class="fu">col_w_vr</span><span class="op">(</span><span class="va">covs0</span>, treat <span class="op">=</span> <span class="va">treat</span>, weights <span class="op">=</span> <span class="va">weights</span>,</span></span>
<span class="r-in"><span>                  bin.vars <span class="op">=</span> <span class="va">bin.vars</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ks <span class="op">=</span> <span class="fu">col_w_ks</span><span class="op">(</span><span class="va">covs0</span>, treat <span class="op">=</span> <span class="va">treat</span>, weights <span class="op">=</span> <span class="va">weights</span>,</span></span>
<span class="r-in"><span>                  bin.vars <span class="op">=</span> <span class="va">bin.vars</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">covs0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    m0       sd0        m1       sd1     smd     vr     ks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age           27.1000   10.8071   25.5663    6.5640 -0.1676 0.3689 0.1912</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ          10.2863    2.7430   10.6064    2.0631  0.1296 0.5657 0.0768</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> race_black     0.3979    0.4895    0.4478    0.4973  0.1302 1.0322 0.0499</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> race_hispan    0.1170    0.3215    0.1217    0.3269  0.0156 1.0344 0.0047</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> race_white     0.4851    0.4998    0.4305    0.4951 -0.1378 0.9815 0.0546</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married        0.4089    0.4916    0.3146    0.4643 -0.2102 0.8920 0.0944</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree       0.6250    0.4841    0.5702    0.4950 -0.1157 1.0456 0.0547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74        4552.7364 6339.3397 2932.1845 5743.4197 -0.2740 0.8208 0.3121</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75        2172.0386 3161.2645 1658.0651 3091.1829 -0.1579 0.9562 0.1526</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare to bal.tab():</span></span></span>
<span class="r-in"><span><span class="fu"><a href="bal.tab.html">bal.tab</a></span><span class="op">(</span><span class="va">covs</span>, treat <span class="op">=</span> <span class="va">treat</span>, weights <span class="op">=</span> <span class="va">weights</span>,</span></span>
<span class="r-in"><span>        disp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m"</span>, <span class="st">"sd"</span><span class="op">)</span>, stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m"</span>, <span class="st">"v"</span>, <span class="st">"ks"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        estimand <span class="op">=</span> <span class="st">"ATE"</span>, method <span class="op">=</span> <span class="st">"weighting"</span>,</span></span>
<span class="r-in"><span>        binary <span class="op">=</span> <span class="st">"std"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="text-decoration: underline;">Balance Measures</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Type   M.0.Adj  SD.0.Adj   M.1.Adj  SD.1.Adj Diff.Adj</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age         Contin.   27.1000   10.8071   25.5663    6.5640  -0.1676</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ        Contin.   10.2863    2.7430   10.6064    2.0631   0.1296</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> race_black   Binary    0.3979    0.4895    0.4478    0.4973   0.1302</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> race_hispan  Binary    0.1170    0.3215    0.1217    0.3269   0.0156</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> race_white   Binary    0.4851    0.4998    0.4305    0.4951  -0.1378</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married      Binary    0.4089    0.4916    0.3146    0.4643  -0.2102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree     Binary    0.6250    0.4841    0.5702    0.4950  -0.1157</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74        Contin. 4552.7364 6339.3397 2932.1845 5743.4197  -0.2740</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75        Contin. 2172.0386 3161.2645 1658.0651 3091.1829  -0.1579</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             V.Ratio.Adj KS.Adj</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age              0.3689 0.1912</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ             0.5657 0.0768</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> race_black            . 0.0499</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> race_hispan           . 0.0047</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> race_white            . 0.0546</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married               . 0.0944</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree              . 0.0547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74             0.8208 0.3121</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75             0.9562 0.1526</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="text-decoration: underline;">Effective sample sizes</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Control Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unadjusted  429.    185.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adjusted    329.01   58.33</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Noah Greifer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

