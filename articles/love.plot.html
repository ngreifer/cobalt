<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="cobalt">
<title>Using `love.plot()` To Generate Love Plots • cobalt</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using `love.plot()` To Generate Love Plots">
<meta property="og:description" content="cobalt">
<meta property="og:image" content="https://ngreifer.github.io/cobalt/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">cobalt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.5.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/cobalt.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/other-packages.html">Using `cobalt` with Other Preprocessing Packages</a>
    <a class="dropdown-item" href="../articles/segmented-data.html">Using `cobalt` with Clustered, Multiply Imputed, and Other Segmented Data</a>
    <a class="dropdown-item" href="../articles/longitudinal-treat.html">Using `cobalt` with Longitudinal Treatments</a>
    <a class="dropdown-item" href="../articles/love.plot.html">Using `love.plot()` To Generate Love Plots</a>
    <a class="dropdown-item" href="../articles/optimizing-balance.html">Optimizing Tuning Parameters for Balance</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ngreifer/cobalt/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Using `love.plot()` To Generate Love Plots</h1>
                        <h4 data-toc-skip class="author">Noah
Greifer</h4>
            
            <h4 data-toc-skip class="date">2023-07-28</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ngreifer/cobalt/blob/HEAD/vignettes/love.plot.Rmd" class="external-link"><code>vignettes/love.plot.Rmd</code></a></small>
      <div class="d-none name"><code>love.plot.Rmd</code></div>
    </div>

    
    
<p>This is a guide on how to use <code><a href="../reference/love.plot.html">love.plot()</a></code> to its fullest
potential, taking advantage of all of its many options and features.
Other vignettes have described the basics of <code><a href="../reference/love.plot.html">love.plot()</a></code>,
but this guide goes more in depth. See the help file for
<code><a href="../reference/love.plot.html">love.plot()</a></code> with <code><a href="../reference/love.plot.html">?love.plot</a></code> for the full
documentation.</p>
<p>This document will only go over the options for
<code><a href="../reference/love.plot.html">love.plot()</a></code> with binary treatments. Many of the options
apply to continuous and multi-category treatments and clustered and
multiply imputed data as well. I’ll use the Lalonde data and
<code>WeightIt</code> for all examples. <code>WeightIt</code> performs a
variety of weighting methods, including propensity score weighting,
which, for simplicity, will be the focus here.</p>
<p>First, let’s load in the data set and estimate the weights.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ngreifer.github.io/cobalt/">cobalt</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"lalonde"</span>, package <span class="op">=</span> <span class="st">"cobalt"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">w.out1</span> <span class="op">&lt;-</span> <span class="fu">WeightIt</span><span class="fu">::</span><span class="fu"><a href="https://ngreifer.github.io/WeightIt/reference/weightit.html" class="external-link">weightit</a></span><span class="op">(</span></span>
<span>    <span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">married</span> <span class="op">+</span> <span class="va">nodegree</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">re74</span> <span class="op">+</span> <span class="va">re75</span>,</span>
<span>    data <span class="op">=</span> <span class="va">lalonde</span>, estimand <span class="op">=</span> <span class="st">"ATE"</span>, method <span class="op">=</span> <span class="st">"ps"</span><span class="op">)</span></span></code></pre></div>
<p>Next, because in this example we want to display standardized mean
difference for all of the covariates, let’s set the global
<code>binary</code> option to <code>"std"</code> so we don’t have to
type it every time.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set.cobalt.options.html">set.cobalt.options</a></span><span class="op">(</span>binary <span class="op">=</span> <span class="st">"std"</span><span class="op">)</span></span></code></pre></div>
<p>The most basic way to use <code><a href="../reference/love.plot.html">love.plot()</a></code> is simply to call
it as you would <code><a href="../reference/bal.tab.html">bal.tab()</a></code> on the output of the
preprocessing function (in this case, <code>weightit</code>).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/love.plot.html">love.plot</a></span><span class="op">(</span><span class="va">w.out1</span><span class="op">)</span></span></code></pre></div>
<p><img src="love.plot_files/figure-html/unnamed-chunk-4-1.png" width="576"></p>
<p>We could also have supplied other arguments that would normally go in
<code><a href="../reference/bal.tab.html">bal.tab()</a></code><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Older versions of &lt;code&gt;cobalt&lt;/code&gt; required the first
argument to be a call to &lt;code&gt;&lt;a href="../reference/bal.tab.html"&gt;bal.tab()&lt;/a&gt;&lt;/code&gt;; this is no longer
required and in fact is not recommended because &lt;code&gt;love.plot&lt;/code&gt;
is more flexible when handling its own inputs. That said,
&lt;code&gt;love.plot&lt;/code&gt; calls &lt;code&gt;bal.tab&lt;/code&gt; internally, so
problems that arise may be due to problems with &lt;code&gt;bal.tab&lt;/code&gt;
rather than with &lt;code&gt;love.plot&lt;/code&gt;. Sometimes the
&lt;code&gt;bal.tab&lt;/code&gt; object can take some time to be produced, in which
case it might be useful to just run &lt;code&gt;bal.tab&lt;/code&gt; once and supply
its output to different calls of &lt;code&gt;love.plot&lt;/code&gt; as you fiddle
with its options, as &lt;code&gt;b &amp;lt;- bal.tab(w.out); love.plot(b)&lt;/code&gt;.
Note that doing so removes some of &lt;code&gt;love.plot&lt;/code&gt; flexibility.
The most important aspect is that &lt;code&gt;love.plot&lt;/code&gt; when called
with the first syntax can modify the implicit call to
&lt;code&gt;bal.tab&lt;/code&gt; to get everything it needs. For example, normally
variance ratios are not present in &lt;code&gt;bal.tab&lt;/code&gt; output, but if
they are requested with &lt;code&gt;stats = "variance.ratios"&lt;/code&gt; in
&lt;code&gt;love.plot&lt;/code&gt;, they will be produced and displayed correctly
without additional input. When using the latter syntax, an error will
occur saying that variance ratios were not present in the original
&lt;code&gt;bal.tab&lt;/code&gt; call. This can be mitigated by setting
&lt;code&gt;quick = FALSE&lt;/code&gt; or including &lt;code&gt;"variance.ratios"&lt;/code&gt;
in the &lt;code&gt;stats&lt;/code&gt; argument in the call to &lt;code&gt;bal.tab&lt;/code&gt;
before entering its output into &lt;code&gt;love.plot&lt;/code&gt;.&lt;/p&gt;'><sup>1</sup></a>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#This produces the same output as the prior block but with </span></span>
<span><span class="co">#the additional covariates included in the formula.</span></span>
<span><span class="fu"><a href="../reference/love.plot.html">love.plot</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">married</span> <span class="op">+</span> <span class="va">nodegree</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">re74</span> <span class="op">+</span> <span class="va">re75</span> <span class="op">+</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">educ</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">lalonde</span>, weights <span class="op">=</span> <span class="fu"><a href="../reference/get.w.html">get.w</a></span><span class="op">(</span><span class="va">w.out1</span><span class="op">)</span>,</span>
<span>          method <span class="op">=</span> <span class="st">"weighting"</span>, estimand <span class="op">=</span> <span class="st">"ATE"</span><span class="op">)</span></span></code></pre></div>
<p>Let’s start with some basic customizations. First, we’ll remove the
propensity score from the balance display by setting
<code>drop.distance = TRUE</code>. We’ll change the order the covariates
so they are displayed in descending order of their unadjusted mean
differences by setting <code>var.order = "unadjusted"</code>. We’ll
display the absolute mean difference by setting <code>abs = TRUE</code>.
We’ll also add some lines to make the change in balance clearer by
setting <code>line = TRUE</code>. Finally, we’ll add a threshold line at
0.1 by setting <code>thresholds = c(m = .1)</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/love.plot.html">love.plot</a></span><span class="op">(</span><span class="va">w.out1</span>, </span>
<span>          drop.distance <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>          var.order <span class="op">=</span> <span class="st">"unadjusted"</span>,</span>
<span>          abs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          line <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>          thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="love.plot_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
<p>The plot is already looking much better and more informative, but
let’s change a few things to make it more professional. First, we’ll
change the names of the variables so they are easier to read. We can
create a vector of new variable names and then supply that to the
<code>var.names</code> argument in <code><a href="../reference/love.plot.html">love.plot()</a></code>. If it would
be a burden to type out all the names, you can use the
<code><a href="../reference/var.names.html">var.names()</a></code> function to create a CSV file (i.e.,
spreadsheet) that can be customized and loaded back into R to be used
with <code><a href="../reference/love.plot.html">love.plot()</a></code>. See <code><a href="../reference/var.names.html">?var.names</a></code> for more
information. Because we only have a few variable names, we’ll just
manually create a vector of names.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new.names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>age <span class="op">=</span> <span class="st">"Age (Years)"</span>,</span>
<span>               educ <span class="op">=</span> <span class="st">"Education (Years)"</span>,</span>
<span>               married <span class="op">=</span> <span class="st">"Married (Y/N)"</span>,</span>
<span>               nodegree <span class="op">=</span> <span class="st">"Degree Earned (Y/N)"</span>,</span>
<span>               race_white <span class="op">=</span> <span class="st">"Race: White"</span>,</span>
<span>               race_black <span class="op">=</span> <span class="st">"Race: Black"</span>,</span>
<span>               race_hispan <span class="op">=</span> <span class="st">"Race: Hispanic"</span>,</span>
<span>               re74 <span class="op">=</span> <span class="st">"Earnings in 1974 ($)"</span>,</span>
<span>               re75 <span class="op">=</span> <span class="st">"Earnings in 1975 ($)"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We’ll change the colors of the points and lines with the
<code>colors</code> argument so they aren’t the <code>ggplot2</code>
defaults. We’ll also change the shape of the points to further clarify
the different samples using the <code>shapes</code> argument.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/love.plot.html">love.plot</a></span><span class="op">(</span><span class="va">w.out1</span>, </span>
<span>          drop.distance <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>          var.order <span class="op">=</span> <span class="st">"unadjusted"</span>,</span>
<span>          abs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          line <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>          thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span>,</span>
<span>          var.names <span class="op">=</span> <span class="va">new.names</span>,</span>
<span>          colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>          shapes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"triangle filled"</span>, <span class="st">"circle filled"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="love.plot_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
<p>Finally, let’s makes some changed to the legend. First, we’ll rename
the samples to be “Unweighted” and “PS Weighted” using the
<code>sample.names</code> argument. Second, we’ll change the plot limits
to give more padding on the right side using the <code>limits</code>
argument. Third, to save some space, we’ll move the legend into the plot
using the <code>position</code> argument, and we’ll give it a border. We
can do this last step using <code>ggplot2</code> syntax because the
<code>love.plot</code> output is a <code>ggplot</code> object. We need
to load in <code>ggplot2</code> first to do this.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/love.plot.html">love.plot</a></span><span class="op">(</span><span class="va">w.out1</span>, </span>
<span>          drop.distance <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>          var.order <span class="op">=</span> <span class="st">"unadjusted"</span>,</span>
<span>          abs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          line <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>          thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span>,</span>
<span>          var.names <span class="op">=</span> <span class="va">new.names</span>,</span>
<span>          colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>          shapes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"triangle filled"</span>, <span class="st">"circle filled"</span><span class="op">)</span>,</span>
<span>          sample.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Unweighted"</span>, <span class="st">"PS Weighted"</span><span class="op">)</span>,</span>
<span>          limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.82</span><span class="op">)</span>,</span>
<span>          position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.75</span>, <span class="fl">.25</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.box.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>        legend.box.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="love.plot_files/figure-html/unnamed-chunk-9-1.png" width="576"></p>
<p>This is starting to look like a publication-ready plot. There are
still other options you can change, such as the title, subtitle, and
axis names, some of which can be done using <code>love.plot</code>
arguments and others which require <code>ggplot2</code> code. Sizing the
plot and making sure everything still looks good will be its own
challenge, but that’s true of all plots in R.</p>
<p>Perhaps we want to display balance for a second set of weights, maybe
using a different method to estimate them, like the covariate balancing
propensity score [CBPS; <span class="citation">Imai and Ratkovic (<a href="#ref-imaiCovariateBalancingPropensity2014" role="doc-biblioref">2014</a>)</span>] that is popular in political
science. These can be easily added (but we’ll have to use the formula
interface to set multiple weights).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">w.out2</span> <span class="op">&lt;-</span> <span class="fu">WeightIt</span><span class="fu">::</span><span class="fu"><a href="https://ngreifer.github.io/WeightIt/reference/weightit.html" class="external-link">weightit</a></span><span class="op">(</span></span>
<span>    <span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">married</span> <span class="op">+</span> <span class="va">nodegree</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">re74</span> <span class="op">+</span> <span class="va">re75</span>,</span>
<span>    data <span class="op">=</span> <span class="va">lalonde</span>, estimand <span class="op">=</span> <span class="st">"ATE"</span>, method <span class="op">=</span> <span class="st">"cbps"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/love.plot.html">love.plot</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">married</span> <span class="op">+</span> <span class="va">nodegree</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">re74</span> <span class="op">+</span> <span class="va">re75</span>,</span>
<span>          data <span class="op">=</span> <span class="va">lalonde</span>, estimand <span class="op">=</span> <span class="st">"ATE"</span>,</span>
<span>          weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>w1 <span class="op">=</span> <span class="fu"><a href="../reference/get.w.html">get.w</a></span><span class="op">(</span><span class="va">w.out1</span><span class="op">)</span>,</span>
<span>                         w2 <span class="op">=</span> <span class="fu"><a href="../reference/get.w.html">get.w</a></span><span class="op">(</span><span class="va">w.out2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          var.order <span class="op">=</span> <span class="st">"unadjusted"</span>,</span>
<span>          abs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          line <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>          thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span>,</span>
<span>          var.names <span class="op">=</span> <span class="va">new.names</span>,</span>
<span>          colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"darkgreen"</span><span class="op">)</span>,</span>
<span>          shapes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"triangle filled"</span>, <span class="st">"circle filled"</span>, <span class="st">"square filled"</span><span class="op">)</span>,</span>
<span>          sample.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Unweighted"</span>, <span class="st">"PS Weighted"</span>, <span class="st">"CBPS Weighted"</span><span class="op">)</span>,</span>
<span>          limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.82</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.75</span>, <span class="fl">.3</span><span class="op">)</span>,</span>
<span>        legend.box.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>        legend.box.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="love.plot_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
<p>We can see there is little benefit to using these weights over
standard logistic regression weights, although significant imbalance
remains for both sets of weights. (Try using entropy balancing by
setting <code>method = "ebal"</code> in <code><a href="https://ngreifer.github.io/WeightIt/reference/weightit.html" class="external-link">weightit()</a></code> if you
want to see the power of modern weighting methods.)</p>
<p>Perhaps balance on mean differences is not enough, and you want to
display balance on KS statistics. In general, this is good practice;
mean differences don’t tell the whole story. We can simply request
<code>stats = ks.statistics"</code> in <code><a href="../reference/love.plot.html">love.plot()</a></code>. We
could also request <code>"variance.ratios"</code> to get variance
ratios, another potentially useful balance measure. Below we’ll use
similar formatting to request KS statistics:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/love.plot.html">love.plot</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">married</span> <span class="op">+</span> <span class="va">nodegree</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">re74</span> <span class="op">+</span> <span class="va">re75</span>,</span>
<span>          data <span class="op">=</span> <span class="va">lalonde</span>, estimand <span class="op">=</span> <span class="st">"ATE"</span>,</span>
<span>          stats <span class="op">=</span> <span class="st">"ks.statistics"</span>,</span>
<span>          weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>w1 <span class="op">=</span> <span class="fu"><a href="../reference/get.w.html">get.w</a></span><span class="op">(</span><span class="va">w.out1</span><span class="op">)</span>,</span>
<span>                         w2 <span class="op">=</span> <span class="fu"><a href="../reference/get.w.html">get.w</a></span><span class="op">(</span><span class="va">w.out2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          var.order <span class="op">=</span> <span class="st">"unadjusted"</span>,</span>
<span>          abs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          line <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>          thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span>,</span>
<span>          var.names <span class="op">=</span> <span class="va">new.names</span>,</span>
<span>          colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"darkgreen"</span><span class="op">)</span>,</span>
<span>          shapes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"triangle filled"</span>, <span class="st">"circle filled"</span>, <span class="st">"square filled"</span><span class="op">)</span>,</span>
<span>          sample.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Unweighted"</span>, <span class="st">"PS Weighted"</span>, <span class="st">"CBPS Weighted"</span><span class="op">)</span>,</span>
<span>          limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.45</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.75</span>, <span class="fl">.25</span><span class="op">)</span>,</span>
<span>        legend.box.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>        legend.box.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="love.plot_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
<p>Below, we’ll put two plots side-by-side, one for mean differences and
one for KS statistics. This can be done by requesting multiple values
for the <code>stats</code> argument (e.g., with
<code>stats = c("mean.diffs", "ks.statistics")</code>). To reduce
clutter, we’ll remove the lines by setting <code>lines = FALSE</code>.
To prevent the axis titles from bumping into each other, we’ll set
<code>wrap = 20</code>, where 20 is the number of characters at which to
wrap to the next line. When <code>stats</code> has length greater than
1, the output is not longer a <code>ggplot</code> object and can’t be
manipulated using <code>ggplot2</code> syntax. This limits some of the
options we have to customize it, but the available options using
<code><a href="../reference/love.plot.html">love.plot()</a></code>’s syntax are still useful. We’ll move the
legend to the top of the plot to save space using the
<code>position</code> argument. We can give the plots different limits
by entering a named list into the <code>limits</code> argument. We can
do the same for the <code>thresholds</code> argument. Finally, by
setting <code>var.order = "unadjusted"</code>, we ensure that the
variable order is the same in both plots (which it will be regardless)
and ordered by the first balance statistic (in this case, mean
differences).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/love.plot.html">love.plot</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">married</span> <span class="op">+</span> <span class="va">nodegree</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">re74</span> <span class="op">+</span> <span class="va">re75</span>,</span>
<span>          data <span class="op">=</span> <span class="va">lalonde</span>, estimand <span class="op">=</span> <span class="st">"ATE"</span>,</span>
<span>          stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean.diffs"</span>, <span class="st">"ks.statistics"</span><span class="op">)</span>,</span>
<span>          weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>w1 <span class="op">=</span> <span class="fu"><a href="../reference/get.w.html">get.w</a></span><span class="op">(</span><span class="va">w.out1</span><span class="op">)</span>,</span>
<span>                         w2 <span class="op">=</span> <span class="fu"><a href="../reference/get.w.html">get.w</a></span><span class="op">(</span><span class="va">w.out2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          var.order <span class="op">=</span> <span class="st">"unadjusted"</span>,</span>
<span>          abs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          line <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>          thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fl">.1</span>, ks <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span>,</span>
<span>          var.names <span class="op">=</span> <span class="va">new.names</span>,</span>
<span>          colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"darkgreen"</span><span class="op">)</span>,</span>
<span>          shapes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"triangle filled"</span>, <span class="st">"circle filled"</span>, <span class="st">"square filled"</span><span class="op">)</span>,</span>
<span>          sample.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Unweighted"</span>, <span class="st">"PS Weighted"</span>, <span class="st">"CBPS Weighted"</span><span class="op">)</span>,</span>
<span>          limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.82</span><span class="op">)</span>,</span>
<span>                        ks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.45</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          wrap <span class="op">=</span> <span class="fl">20</span>,</span>
<span>          position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="love.plot_files/figure-html/unnamed-chunk-12-1.png" width="576"></p>
<p>Below we recreate the plot in <span class="citation">West et al. (<a href="#ref-westPropensityScoresBasis2014" role="doc-biblioref">2014</a>)</span>, which uses a simple theme and
avoids color, which can be important for publication. In addition, the
plot has labels and puts the legend in a different position. We can
include those features by including an argument to <code>labels</code>
and by supplying a <code>theme</code> object to <code>themes</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/love.plot.html">love.plot</a></span><span class="op">(</span><span class="va">w.out1</span>, abs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean.diffs"</span>, <span class="st">"variance.ratios"</span><span class="op">)</span>,</span>
<span>          drop.distance <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          var.names <span class="op">=</span> <span class="va">new.names</span>,</span>
<span>          thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>          limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.9</span>, <span class="fl">.9</span><span class="op">)</span>,</span>
<span>                        v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.3</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          shapes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"circle filled"</span>, <span class="st">"circle"</span><span class="op">)</span>,</span>
<span>          position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>          labels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>          wrap <span class="op">=</span> <span class="fl">20</span>,</span>
<span>          themes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.75</span>, <span class="fl">1.09</span><span class="op">)</span>, </span>
<span>                                  legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>                                  legend.key.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">.02</span>, <span class="st">"npc"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="love.plot_files/figure-html/unnamed-chunk-13-1.png" width="576"></p>
<p>When using <code>love.plot</code>, you might see a warning that says
<code>Standardized mean differences and raw mean differences are present in the same plot. Use the 'stars' argument to distinguish between them and appropriately label the x-axis.</code>.
We avoided this here by setting <code>binary</code> to
<code>"std"</code> so that only standardized mean differences are
produced when requesting <code>stats = "mean.diffs"</code>. The
<code>stars</code> argument adds an asterisk (or a character of your
choice) to the names of variables that either have standardized mean
difference or raw mean differences, whichever you choose. The idea is
that the asterisk will be explained in a caption below the plot,
indicating that the axis title doesn’t fully represent how that
variable’s mean difference is displayed. For example, you might make the
following plot:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/love.plot.html">love.plot</a></span><span class="op">(</span><span class="va">w.out1</span>, binary <span class="op">=</span> <span class="st">"raw"</span>,</span>
<span>          stars <span class="op">=</span> <span class="st">"raw"</span>,</span>
<span>          drop.distance <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          var.names <span class="op">=</span> <span class="va">new.names</span><span class="op">)</span></span></code></pre></div>
<p><img src="love.plot_files/figure-html/unnamed-chunk-14-1.png" width="576"></p>
<p>By setting <code>stars = "raw"</code>, asterisks appear next to the
variables for which the raw difference in means (i.e., proportions) is
displayed, contradicting the axis title. In the figure’s caption, you
might write</p>
<blockquote>
<p>* indicates variables for which the displayed value is the raw
(unstandardized) difference in means.</p>
</blockquote>
<p>This ensures readers can fully and accurately interpret the plot. My
suggestion is to display standardized mean differences for all variables
as well as KS statistics. The KS statistic for a binary variable is the
raw difference in proportion, so that information is not lost.</p>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-imaiCovariateBalancingPropensity2014" class="csl-entry">
Imai, Kosuke, and Marc Ratkovic. 2014. <span>“Covariate Balancing
Propensity Score.”</span> <em>Journal of the Royal Statistical Society:
Series B (Statistical Methodology)</em> 76 (1): 243–63. <a href="https://doi.org/10.1111/rssb.12027" class="external-link">https://doi.org/10.1111/rssb.12027</a>.
</div>
<div id="ref-westPropensityScoresBasis2014" class="csl-entry">
West, Stephen G., Heining Cham, Felix J. Thoemmes, Babette Renneberg,
Julian Schulze, and Matthias Weiler. 2014. <span>“Propensity Scores as a
Basis for Equating Groups: Basic Principles and Application in Clinical
Treatment Outcome Research.”</span> <em>Journal of Consulting and
Clinical Psychology</em> 82 (5): 906–19. <a href="https://doi.org/10.1037/a0036387" class="external-link">https://doi.org/10.1037/a0036387</a>.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Noah Greifer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
